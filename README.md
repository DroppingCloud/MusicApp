# ğŸµ ç½‘æ˜“äº‘éŸ³ä¹ä»¿åˆ¶é¡¹ç›® - åç«¯APIæœåŠ¡

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Node.js + Koa2** å¼€å‘çš„éŸ³ä¹åº”ç”¨åç«¯APIæœåŠ¡ï¼Œä»¿ç…§ç½‘æ˜“äº‘éŸ³ä¹APPçš„åŠŸèƒ½è®¾è®¡ã€‚é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œä¸ºé¸¿è’™ArkTSå‰ç«¯åº”ç”¨æä¾›å®Œæ•´çš„RESTful APIæœåŠ¡ã€‚

## ğŸ“– æ–‡æ¡£ç›®å½•

- [ğŸ“‹ é¡¹ç›®æ¦‚è¿°](#-é¡¹ç›®æ¦‚è¿°)
- [ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„](#-é¡¹ç›®ç›®å½•ç»“æ„)
- [ğŸ—ï¸ æ¶æ„è®¾è®¡](#ï¸-æ¶æ„è®¾è®¡)
  - [åˆ†å±‚æ¶æ„](#åˆ†å±‚æ¶æ„)
  - [ä¸šåŠ¡é€»è¾‘æµç¨‹å›¾](#ä¸šåŠ¡é€»è¾‘æµç¨‹å›¾)
  - [æ¨¡å—åˆ’åˆ†](#æ¨¡å—åˆ’åˆ†)
- [ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [ğŸ“š APIæ¥å£æ–‡æ¡£](#-apiæ¥å£æ–‡æ¡£)
- [ğŸ”§ å¼€å‘è¯´æ˜](#-å¼€å‘è¯´æ˜)
- [ğŸ“ å¼€å‘ä»»åŠ¡](#-å¼€å‘ä»»åŠ¡)
- [ğŸ§ª æµ‹è¯•](#-æµ‹è¯•)
- [ğŸ“Š éƒ¨ç½²](#-éƒ¨ç½²)

### ğŸ¯ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Node.js + Koa2
- **æ•°æ®åº“**: MySQL 8.0+
- **ç¼“å­˜**: Redis
- **åŒ…ç®¡ç†**: pnpm
- **è®¤è¯**: JWT
- **å‚æ•°éªŒè¯**: Joi
- **æ—¥å¿—**: Winston
- **æµ‹è¯•**: Jest
- **ä»£ç è§„èŒƒ**: ESLint

### ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- âœ… **å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ** - æ³¨å†Œã€ç™»å½•ã€ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- âœ… **éŸ³ä¹æ’­æ”¾åŠŸèƒ½** - æ­Œæ›²ç®¡ç†ã€æ’­æ”¾å†å²ã€æ¨èç®—æ³•
- âœ… **æ­Œå•ç³»ç»Ÿ** - åˆ›å»ºã€ç®¡ç†ã€æ”¶è—æ­Œå•
- âœ… **æœç´¢åŠŸèƒ½** - å…¨æ–‡æœç´¢æ­Œæ›²ã€æ­Œæ‰‹ã€æ­Œå•ã€ç”¨æˆ·
- âœ… **ç¤¾äº¤åŠŸèƒ½** - å…³æ³¨ã€è¯„è®ºã€ç‚¹èµã€ç§ä¿¡
- âœ… **ç¬”è®°ç³»ç»Ÿ** - éŸ³ä¹ç¬”è®°å‘å¸ƒä¸åˆ†äº«
- âœ… **å®‰å…¨ä¿éšœ** - JWTè®¤è¯ã€APIé™æµã€å‚æ•°éªŒè¯
- âœ… **æ€§èƒ½ä¼˜åŒ–** - Redisç¼“å­˜ã€æ•°æ®åº“ç´¢å¼•ã€åˆ†é¡µæŸ¥è¯¢

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
my-server/
â”œâ”€â”€ src/                        # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ app.js                  # åº”ç”¨ç¨‹åºå…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ index.js           # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ database.js        # æ•°æ®åº“è¿æ¥é…ç½®
â”‚   â”œâ”€â”€ controllers/           # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”œâ”€â”€ auth-controller.js # è®¤è¯æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ user-controller.js # ç”¨æˆ·æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ song-controller.js # æ­Œæ›²æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ playlist-controller.js # æ­Œå•æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ search-controller.js # æœç´¢æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ note-controller.js # ç¬”è®°æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ social-controller.js # ç¤¾äº¤æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ services/              # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ user-service.js    # ç”¨æˆ·ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ song-service.js    # æ­Œæ›²ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ playlist-service.js # æ­Œå•ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ search-service.js  # æœç´¢ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ note-service.js    # ç¬”è®°ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ social-service.js  # ç¤¾äº¤ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ models/                # æ•°æ®æ¨¡å‹å±‚
â”‚   â”‚   â””â”€â”€ user.js           # ç”¨æˆ·æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/                # è·¯ç”±å±‚
â”‚   â”‚   â”œâ”€â”€ index.js          # ä¸»è·¯ç”±æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ auth-routes.js    # è®¤è¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ user-routes.js    # ç”¨æˆ·è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ song-routes.js    # æ­Œæ›²è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ playlist-routes.js # æ­Œå•è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ search-routes.js  # æœç´¢è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ note-routes.js    # ç¬”è®°è·¯ç”±
â”‚   â”‚   â””â”€â”€ social-routes.js  # ç¤¾äº¤è·¯ç”±
â”‚   â”œâ”€â”€ middleware/            # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ error-handler.js  # å…¨å±€é”™è¯¯å¤„ç†
â”‚   â”‚   â”œâ”€â”€ auth.js           # JWTè®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ rate-limit.js     # APIé™æµä¸­é—´ä»¶
â”‚   â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ logger.js         # æ—¥å¿—å·¥å…·
â”‚       â””â”€â”€ response.js       # å“åº”æ ¼å¼åŒ–
â”œâ”€â”€ database/                  # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ create_tables.sql     # å»ºè¡¨è„šæœ¬
â”‚   â””â”€â”€ README.md             # æ•°æ®åº“è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ doc/                       # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ äº§å“åŠŸèƒ½æ–‡æ¡£.md        # äº§å“åŠŸèƒ½è®¾è®¡
â”‚   â””â”€â”€ è¡¨ç»“æ„è®¾è®¡.md          # æ•°æ®åº“è®¾è®¡
â”œâ”€â”€ logs/                      # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ uploads/                   # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”œâ”€â”€ tests/                     # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”œâ”€â”€ package.json              # é¡¹ç›®é…ç½®æ–‡ä»¶
â””â”€â”€ README.md                 # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

é¡¹ç›®é‡‡ç”¨ç»å…¸çš„ä¸‰å±‚æ¶æ„æ¨¡å¼ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Controller    â”‚  â† æ§åˆ¶å™¨å±‚ï¼šå¤„ç†HTTPè¯·æ±‚ï¼Œå‚æ•°éªŒè¯ï¼Œè°ƒç”¨Service
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Service      â”‚  â† ä¸šåŠ¡é€»è¾‘å±‚ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œäº‹åŠ¡ç®¡ç†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Model       â”‚  â† æ•°æ®è®¿é—®å±‚ï¼šæ•°æ®åº“æ“ä½œï¼ŒSQLæŸ¥è¯¢
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“‹ ç›®å½•å¯¼èˆª

- [ğŸ” ç”¨æˆ·è®¤è¯æµç¨‹](#1--ç”¨æˆ·è®¤è¯æµç¨‹)
- [ğŸµ éŸ³ä¹æ’­æ”¾æµç¨‹](#2--éŸ³ä¹æ’­æ”¾æµç¨‹)  
- [ğŸ“ æ­Œå•ç®¡ç†æµç¨‹](#3--æ­Œå•ç®¡ç†æµç¨‹)
- [ğŸ” æœç´¢æµç¨‹](#4--æœç´¢æµç¨‹)
- [ğŸ’¬ ç¤¾äº¤äº’åŠ¨æµç¨‹](#5--ç¤¾äº¤äº’åŠ¨æµç¨‹)
- [ğŸ¯ æ¨èç®—æ³•æµç¨‹](#6--æ¨èç®—æ³•æµç¨‹)
- [ğŸ—ï¸ ç³»ç»Ÿæ•´ä½“æ¶æ„](#7--ç³»ç»Ÿæ•´ä½“æ¶æ„æµç¨‹)
- [ğŸ“Š æ•°æ®åº“å…³ç³»å›¾](#8--æ•°æ®åº“å…³ç³»å›¾)

### ä¸šåŠ¡é€»è¾‘æµç¨‹å›¾

#### 1. ğŸ” ç”¨æˆ·è®¤è¯æµç¨‹

```mermaid
graph TD
    A["å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚"] --> B{è¯·æ±‚ç±»å‹}
    B -->|æ³¨å†Œ| C["POST /auth/register"]
    B -->|ç™»å½•| D["POST /auth/login"]
    B -->|åˆ·æ–°ä»¤ç‰Œ| E["POST /auth/refresh"]
    
    C --> C1["å‚æ•°éªŒè¯ (Joi)"]
    C1 --> C2["æ£€æŸ¥ç”¨æˆ·å/é‚®ç®±æ˜¯å¦å­˜åœ¨"]
    C2 -->|å·²å­˜åœ¨| C3["è¿”å›409é”™è¯¯"]
    C2 -->|ä¸å­˜åœ¨| C4["å¯†ç åŠ å¯† (bcrypt)"]
    C4 --> C5["åˆ›å»ºç”¨æˆ·è®°å½•"]
    C5 --> C6["ç”ŸæˆJWTä»¤ç‰Œ"]
    C6 --> C7["è¿”å›ç”¨æˆ·ä¿¡æ¯å’Œä»¤ç‰Œ"]
    
    D --> D1["å‚æ•°éªŒè¯"]
    D1 --> D2["éªŒè¯ç”¨æˆ·å/å¯†ç "]
    D2 -->|éªŒè¯å¤±è´¥| D3["è¿”å›401é”™è¯¯"]
    D2 -->|éªŒè¯æˆåŠŸ| D4["ç”ŸæˆJWTä»¤ç‰Œ"]
    D4 --> D5["è¿”å›ç”¨æˆ·ä¿¡æ¯å’Œä»¤ç‰Œ"]
    
    E --> E1["éªŒè¯åˆ·æ–°ä»¤ç‰Œ"]
    E1 -->|æ— æ•ˆ| E2["è¿”å›401é”™è¯¯"]
    E1 -->|æœ‰æ•ˆ| E3["ç”Ÿæˆæ–°çš„è®¿é—®ä»¤ç‰Œ"]
    E3 --> E4["è¿”å›æ–°ä»¤ç‰Œ"]
    
    style A fill:#e1f5fe
    style C7 fill:#c8e6c9
    style D5 fill:#c8e6c9
    style E4 fill:#c8e6c9
    style C3 fill:#ffcdd2
    style D3 fill:#ffcdd2
    style E2 fill:#ffcdd2
```

#### 2. ğŸµ éŸ³ä¹æ’­æ”¾æµç¨‹

```mermaid
graph TD
    A["ç”¨æˆ·é€‰æ‹©æ­Œæ›²"] --> B["POST /song/play"]
    B --> C["JWTè®¤è¯ä¸­é—´ä»¶"]
    C -->|è®¤è¯å¤±è´¥| D["è¿”å›401é”™è¯¯"]
    C -->|è®¤è¯æˆåŠŸ| E["è·å–æ­Œæ›²ä¿¡æ¯"]
    E -->|æ­Œæ›²ä¸å­˜åœ¨| F["è¿”å›404é”™è¯¯"]
    E -->|æ­Œæ›²å­˜åœ¨| G["æ£€æŸ¥æ’­æ”¾æƒé™"]
    G -->|æ— æƒé™| H["è¿”å›403é”™è¯¯"]
    G -->|æœ‰æƒé™| I["è®°å½•æ’­æ”¾å†å²"]
    I --> J["æ›´æ–°æ­Œæ›²æ’­æ”¾ç»Ÿè®¡"]
    J --> K["è¿”å›æ’­æ”¾ä¿¡æ¯"]
    K --> L["å®¢æˆ·ç«¯å¼€å§‹æ’­æ”¾"]
    L --> M["æ¨èç®—æ³•æ›´æ–°ç”¨æˆ·åå¥½"]
    M --> N["ç”Ÿæˆä¸ªæ€§åŒ–æ¨è"]
    
    style A fill:#e1f5fe
    style K fill:#c8e6c9
    style L fill:#c8e6c9
    style N fill:#c8e6c9
    style D fill:#ffcdd2
    style F fill:#ffcdd2
    style H fill:#ffcdd2
```

#### 3. ğŸ“ æ­Œå•ç®¡ç†æµç¨‹

```mermaid
graph TD
    A["æ­Œå•æ“ä½œè¯·æ±‚"] --> B{æ“ä½œç±»å‹}
    B -->|åˆ›å»ºæ­Œå•| C["POST /playlist/create"]
    B -->|æ·»åŠ æ­Œæ›²| D["POST /playlist/add-song"]
    B -->|æ”¶è—æ­Œå•| E["POST /playlist/collect"]
    
    C --> C1["JWTè®¤è¯"]
    C1 --> C2["å‚æ•°éªŒè¯"]
    C2 --> C3["åˆ›å»ºæ­Œå•è®°å½•"]
    C3 --> C4["è¿”å›æ­Œå•ä¿¡æ¯"]
    
    D --> D1["JWTè®¤è¯"]
    D1 --> D2["éªŒè¯æ­Œå•æƒé™"]
    D2 -->|æ— æƒé™| D3["è¿”å›403é”™è¯¯"]
    D2 -->|æœ‰æƒé™| D4["æ£€æŸ¥æ­Œæ›²æ˜¯å¦å­˜åœ¨"]
    D4 -->|ä¸å­˜åœ¨| D5["è¿”å›404é”™è¯¯"]
    D4 -->|å­˜åœ¨| D6["æ·»åŠ åˆ°æ­Œå•"]
    D6 --> D7["æ›´æ–°æ­Œå•ç»Ÿè®¡"]
    D7 --> D8["è¿”å›æˆåŠŸ"]
    
    E --> E1["JWTè®¤è¯"]
    E1 --> E2["æ£€æŸ¥æ˜¯å¦å·²æ”¶è—"]
    E2 -->|å·²æ”¶è—| E3["è¿”å›409é”™è¯¯"]
    E2 -->|æœªæ”¶è—| E4["æ·»åŠ æ”¶è—è®°å½•"]
    E4 --> E5["è¿”å›æˆåŠŸ"]
    
    style A fill:#e1f5fe
    style C4 fill:#c8e6c9
    style D8 fill:#c8e6c9
    style E5 fill:#c8e6c9
    style D3 fill:#ffcdd2
    style D5 fill:#ffcdd2
    style E3 fill:#ffcdd2
```

#### 4. ğŸ” æœç´¢æµç¨‹

```mermaid
graph TD
    A["ç”¨æˆ·è¾“å…¥æœç´¢å…³é”®è¯"] --> B["GET /search"]
    B --> C["APIé™æµæ£€æŸ¥"]
    C -->|è¶…å‡ºé™åˆ¶| D["è¿”å›429é”™è¯¯"]
    C -->|é€šè¿‡é™åˆ¶| E["å‚æ•°éªŒè¯"]
    E --> F{æœç´¢ç±»å‹}
    F -->|ç»¼åˆæœç´¢| G["æœç´¢æ‰€æœ‰å†…å®¹"]
    F -->|æ­Œæ›²æœç´¢| H["æœç´¢æ­Œæ›²"]
    F -->|æ­Œæ‰‹æœç´¢| I["æœç´¢æ­Œæ‰‹"]
    F -->|æ­Œå•æœç´¢| J["æœç´¢æ­Œå•"]
    
    G --> G1["å¹¶è¡ŒæŸ¥è¯¢æ•°æ®åº“"]
    G1 --> G2["æ­Œæ›²æ¨¡ç³ŠåŒ¹é…"]
    G1 --> G3["æ­Œæ‰‹æ¨¡ç³ŠåŒ¹é…"]
    G1 --> G4["æ­Œå•æ¨¡ç³ŠåŒ¹é…"]
    G2 --> K["åˆå¹¶æœç´¢ç»“æœ"]
    G3 --> K
    G4 --> K
    
    H --> H1["æ­Œæ›²è¡¨æŸ¥è¯¢"]
    I --> I1["æ­Œæ‰‹è¡¨æŸ¥è¯¢"]
    J --> J1["æ­Œå•è¡¨æŸ¥è¯¢"]
    H1 --> K
    I1 --> K
    J1 --> K
    
    K --> L["è®°å½•æœç´¢å†å²"]
    L --> M["æ›´æ–°æœç´¢çƒ­è¯"]
    M --> N["è¿”å›æœç´¢ç»“æœ"]
    
    style A fill:#e1f5fe
    style N fill:#c8e6c9
    style D fill:#ffcdd2
```

#### 5. ğŸ’¬ ç¤¾äº¤äº’åŠ¨æµç¨‹

```mermaid
graph TD
    A["ç¤¾äº¤æ“ä½œè¯·æ±‚"] --> B{æ“ä½œç±»å‹}
    B -->|å…³æ³¨ç”¨æˆ·| C["POST /user/follow"]
    B -->|å‘è¡¨è¯„è®º| D["POST /social/comment"]
    B -->|ç‚¹èµ| E["POST /social/like"]
    B -->|å‘é€ç§ä¿¡| F["POST /social/chat/send"]
    
    C --> C1["JWTè®¤è¯"]
    C1 --> C2["æ£€æŸ¥æ˜¯å¦å·²å…³æ³¨"]
    C2 -->|å·²å…³æ³¨| C3["è¿”å›409é”™è¯¯"]
    C2 -->|æœªå…³æ³¨| C4["åˆ›å»ºå…³æ³¨è®°å½•"]
    C4 --> C5["æ›´æ–°å…³æ³¨ç»Ÿè®¡"]
    C5 --> C6["ç”Ÿæˆå…³æ³¨é€šçŸ¥"]
    C6 --> C7["è¿”å›æˆåŠŸ"]
    
    D --> D1["JWTè®¤è¯"]
    D1 --> D2["å‚æ•°éªŒè¯"]
    D2 --> D3["æ£€æŸ¥ç›®æ ‡æ˜¯å¦å­˜åœ¨"]
    D3 -->|ä¸å­˜åœ¨| D4["è¿”å›404é”™è¯¯"]
    D3 -->|å­˜åœ¨| D5["åˆ›å»ºè¯„è®ºè®°å½•"]
    D5 --> D6["æ›´æ–°è¯„è®ºç»Ÿè®¡"]
    D6 --> D7["ç”Ÿæˆè¯„è®ºé€šçŸ¥"]
    D7 --> D8["è¿”å›è¯„è®ºä¿¡æ¯"]
    
    E --> E1["JWTè®¤è¯"]
    E1 --> E2["æ£€æŸ¥æ˜¯å¦å·²ç‚¹èµ"]
    E2 -->|å·²ç‚¹èµ| E3["è¿”å›409é”™è¯¯"]
    E2 -->|æœªç‚¹èµ| E4["åˆ›å»ºç‚¹èµè®°å½•"]
    E4 --> E5["æ›´æ–°ç‚¹èµç»Ÿè®¡"]
    E5 --> E6["ç”Ÿæˆç‚¹èµé€šçŸ¥"]
    E6 --> E7["è¿”å›æˆåŠŸ"]
    
    F --> F1["JWTè®¤è¯"]
    F1 --> F2["æ£€æŸ¥èŠå¤©æƒé™"]
    F2 -->|æ— æƒé™| F3["è¿”å›403é”™è¯¯"]
    F2 -->|æœ‰æƒé™| F4["åˆ›å»º/è·å–èŠå¤©ä¼šè¯"]
    F4 --> F5["å‘é€æ¶ˆæ¯"]
    F5 --> F6["æ›´æ–°ä¼šè¯ä¿¡æ¯"]
    F6 --> F7["æ¨é€æ¶ˆæ¯é€šçŸ¥"]
    F7 --> F8["è¿”å›æ¶ˆæ¯ä¿¡æ¯"]
    
    style A fill:#e1f5fe
    style C7 fill:#c8e6c9
    style D8 fill:#c8e6c9
    style E7 fill:#c8e6c9
    style F8 fill:#c8e6c9
    style C3 fill:#ffcdd2
    style D4 fill:#ffcdd2
    style E3 fill:#ffcdd2
    style F3 fill:#ffcdd2
```

#### 6. ğŸ¯ æ¨èç®—æ³•æµç¨‹

```mermaid
graph TD
    A["ç”¨æˆ·è¡Œä¸ºæ•°æ®"] --> B["æ•°æ®æ”¶é›†æ¨¡å—"]
    B --> B1["æ’­æ”¾å†å²"]
    B --> B2["ç‚¹èµè®°å½•"]
    B --> B3["æ”¶è—è¡Œä¸º"]
    B --> B4["æœç´¢å†å²"]
    
    B1 --> C["ç”¨æˆ·åå¥½åˆ†æ"]
    B2 --> C
    B3 --> C
    B4 --> C
    
    C --> D["ç‰¹å¾æå–"]
    D --> E["è®¡ç®—ç”¨æˆ·ç”»åƒ"]
    E --> F{æ¨èç­–ç•¥}
    
    F -->|ååŒè¿‡æ»¤| G["åŸºäºç”¨æˆ·ç›¸ä¼¼åº¦æ¨è"]
    F -->|å†…å®¹æ¨è| H["åŸºäºéŸ³ä¹ç‰¹å¾æ¨è"]
    F -->|çƒ­é—¨æ¨è| I["åŸºäºæ’­æ”¾ç»Ÿè®¡æ¨è"]
    
    G --> G1["æŸ¥æ‰¾ç›¸ä¼¼ç”¨æˆ·"]
    G1 --> G2["è·å–ç›¸ä¼¼ç”¨æˆ·å–œå¥½"]
    G2 --> J["ç”Ÿæˆæ¨èåˆ—è¡¨"]
    
    H --> H1["åˆ†æéŸ³ä¹æ ‡ç­¾"]
    H1 --> H2["åŒ¹é…ç”¨æˆ·åå¥½"]
    H2 --> J
    
    I --> I1["è·å–çƒ­é—¨æ­Œæ›²"]
    I1 --> I2["è¿‡æ»¤å·²å¬æ­Œæ›²"]
    I2 --> J
    
    J --> K["æ¨èç»“æœæ’åº"]
    K --> L["ç¼“å­˜æ¨èç»“æœ"]
    L --> M["è¿”å›ä¸ªæ€§åŒ–æ¨è"]
    
    style A fill:#e1f5fe
         style M fill:#c8e6c9
     style L fill:#fff3e0
```

#### 7. ğŸ—ï¸ ç³»ç»Ÿæ•´ä½“æ¶æ„æµç¨‹

```mermaid
graph TB
    subgraph "å®¢æˆ·ç«¯å±‚"
        A1["é¸¿è’™ArkTSå®¢æˆ·ç«¯"]
        A2["Webç®¡ç†åå°"]
    end
    
    subgraph "ç½‘å…³å±‚"
        B1["Nginxåå‘ä»£ç†"]
        B2["è´Ÿè½½å‡è¡¡"]
    end
    
    subgraph "åº”ç”¨å±‚"
        C1["Koa2 HTTPæœåŠ¡å™¨"]
        C2["JWTè®¤è¯ä¸­é—´ä»¶"]
        C3["APIé™æµä¸­é—´ä»¶"]
        C4["å…¨å±€é”™è¯¯å¤„ç†"]
    end
    
    subgraph "ä¸šåŠ¡å±‚"
        D1["è®¤è¯æœåŠ¡ (Auth)"]
        D2["ç”¨æˆ·æœåŠ¡ (User)"]
        D3["éŸ³ä¹æœåŠ¡ (Song)"]
        D4["æ­Œå•æœåŠ¡ (Playlist)"]
        D5["æœç´¢æœåŠ¡ (Search)"]
        D6["ç¤¾äº¤æœåŠ¡ (Social)"]
        D7["æ¨èæœåŠ¡ (Recommend)"]
    end
    
    subgraph "æ•°æ®è®¿é—®å±‚"
        E1["ç”¨æˆ·æ¨¡å‹ (User)"]
        E2["æ­Œæ›²æ¨¡å‹ (Song)"]
        E3["æ­Œå•æ¨¡å‹ (Playlist)"]
        E4["è¯„è®ºæ¨¡å‹ (Comment)"]
    end
    
    subgraph "æ•°æ®å­˜å‚¨å±‚"
        F1[("MySQL<br/>ä¸»æ•°æ®åº“")]
        F2[("Redis<br/>ç¼“å­˜æ•°æ®åº“")]
        F3[("æ–‡ä»¶å­˜å‚¨<br/>éŸ³é¢‘/å›¾ç‰‡")]
    end
    
    subgraph "å¤–éƒ¨æœåŠ¡"
        G1["æ¨é€æœåŠ¡"]
        G2["çŸ­ä¿¡æœåŠ¡"]
        G3["äº‘å­˜å‚¨æœåŠ¡"]
    end
    
    A1 --> B1
    A2 --> B1
    B1 --> B2
    B2 --> C1
    C1 --> C2
    C2 --> C3
    C3 --> C4
    
    C4 --> D1
    C4 --> D2
    C4 --> D3
    C4 --> D4
    C4 --> D5
    C4 --> D6
    C4 --> D7
    
    D1 --> E1
    D2 --> E1
    D3 --> E2
    D3 --> E3
    D4 --> E3
    D5 --> E1
    D5 --> E2
    D5 --> E3
    D6 --> E4
    D7 --> E1
    D7 --> E2
    
    E1 --> F1
    E2 --> F1
    E3 --> F1
    E4 --> F1
    
    D1 --> F2
    D3 --> F2
    D5 --> F2
    D7 --> F2
    
    D3 --> F3
    D6 --> G1
    D1 --> G2
    F3 --> G3
    
    style A1 fill:#e3f2fd
    style A2 fill:#e3f2fd
    style C1 fill:#fff3e0
    style D1 fill:#f3e5f5
    style D2 fill:#f3e5f5
    style D3 fill:#f3e5f5
    style D4 fill:#f3e5f5
    style D5 fill:#f3e5f5
    style D6 fill:#f3e5f5
    style D7 fill:#f3e5f5
    style F1 fill:#e8f5e8
    style F2 fill:#fce4ec
    style F3 fill:#fff8e1
```

#### 8. ğŸ“Š æ•°æ®åº“å…³ç³»å›¾

```mermaid
erDiagram
    USER ||--o{ USER_HISTORY : "æ’­æ”¾å†å²"
    USER ||--o{ USER_FAVORITE : "å–œæ¬¢æ­Œæ›²"
    USER ||--o{ USER_COLLECT : "æ”¶è—æ­Œå•"
    USER ||--o{ FOLLOW : "å…³æ³¨å…³ç³»"
    USER ||--o{ PLAYLIST : "åˆ›å»ºæ­Œå•"
    USER ||--o{ NOTE : "å‘å¸ƒç¬”è®°"
    USER ||--o{ COMMENT : "å‘è¡¨è¯„è®º"
    USER ||--o{ LIKE : "ç‚¹èµè¡Œä¸º"
    USER ||--o{ SEARCH_HISTORY : "æœç´¢å†å²"
    
    SONG ||--o{ USER_HISTORY : "è¢«æ’­æ”¾"
    SONG ||--o{ USER_FAVORITE : "è¢«å–œæ¬¢"
    SONG ||--o{ PLAYLIST_SONG : "åœ¨æ­Œå•ä¸­"
    SONG ||--o{ COMMENT : "è¢«è¯„è®º"
    SONG ||--o{ LIKE : "è¢«ç‚¹èµ"
    SONG ||--o{ SONG_TAG : "æ ‡ç­¾å…³è”"
    SONG }|--|| ARTIST : "æ¼”å”±è€…"
    SONG }|--|| ALBUM : "æ‰€å±ä¸“è¾‘"
    
    PLAYLIST ||--o{ PLAYLIST_SONG : "åŒ…å«æ­Œæ›²"
    PLAYLIST ||--o{ USER_COLLECT : "è¢«æ”¶è—"
    PLAYLIST ||--o{ COMMENT : "è¢«è¯„è®º"
    PLAYLIST ||--o{ LIKE : "è¢«ç‚¹èµ"
    
    NOTE ||--o{ NOTE_IMAGE : "åŒ…å«å›¾ç‰‡"
    NOTE ||--o{ COMMENT : "è¢«è¯„è®º"
    NOTE ||--o{ LIKE : "è¢«ç‚¹èµ"
    
    TAG ||--o{ SONG_TAG : "æ ‡ç­¾å…³è”"
    TAG ||--o{ USER_PROFILE_TAG : "ç”¨æˆ·åå¥½"
    
    USER {
        BIGINT id PK
        VARCHAR username
        VARCHAR password
        VARCHAR email
        VARCHAR avatar
        DATETIME created_at
    }
    
    SONG {
        BIGINT id PK
        VARCHAR title
        BIGINT artist_id FK
        BIGINT album_id FK
        VARCHAR audio_url
        INT duration
        DATE release_date
    }
    
    PLAYLIST {
        BIGINT id PK
        VARCHAR title
        BIGINT user_id FK
        VARCHAR description
        VARCHAR cover_url
        DATETIME create_time
    }
```

### æ¨¡å—åˆ’åˆ†

æ ¹æ®äº§å“åŠŸèƒ½æ–‡æ¡£ï¼Œé¡¹ç›®åˆ’åˆ†ä¸ºä»¥ä¸‹æ ¸å¿ƒæ¨¡å—ï¼š

#### 1. ğŸ‘¤ ç”¨æˆ·æ¨¡å— (`/user`)
- **åŠŸèƒ½**: ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¸ªäººä¿¡æ¯ç®¡ç†ã€å…³æ³¨å…³ç³»
- **æ¥å£å‰ç¼€**: `/user`
- **æ–‡ä»¶**: 
  - Controller: `user-controller.js`
  - Service: `user-service.js`
  - Model: `user.js`
  - Routes: `user-routes.js`

#### 2. ğŸ” è®¤è¯æ¨¡å— (`/auth`)
- **åŠŸèƒ½**: JWTè®¤è¯ã€ä»¤ç‰Œç®¡ç†ã€ç™»å½•éªŒè¯
- **æ¥å£å‰ç¼€**: `/auth`
- **æ–‡ä»¶**:
  - Controller: `auth-controller.js`
  - Middleware: `auth.js`
  - Routes: `auth-routes.js`

#### 3. ğŸµ æ­Œæ›²æ¨¡å— (`/song`)
- **åŠŸèƒ½**: æ­Œæ›²ç®¡ç†ã€æ’­æ”¾è®°å½•ã€æ¨èç®—æ³•ã€å–œæ¬¢åŠŸèƒ½
- **æ¥å£å‰ç¼€**: `/song`
- **æ–‡ä»¶**:
  - Controller: `song-controller.js`
  - Service: `song-service.js`
  - Routes: `song-routes.js`

#### 4. ğŸ“ æ­Œå•æ¨¡å— (`/playlist`)
- **åŠŸèƒ½**: æ­Œå•åˆ›å»ºã€ç®¡ç†ã€æ”¶è—ã€æ­Œæ›²æ·»åŠ /ç§»é™¤
- **æ¥å£å‰ç¼€**: `/playlist`
- **æ–‡ä»¶**:
  - Controller: `playlist-controller.js`
  - Service: `playlist-service.js`
  - Routes: `playlist-routes.js`

#### 5. ğŸ” æœç´¢æ¨¡å— (`/search`)
- **åŠŸèƒ½**: å…¨æ–‡æœç´¢ã€æœç´¢å»ºè®®ã€çƒ­é—¨æœç´¢ã€æœç´¢å†å²
- **æ¥å£å‰ç¼€**: `/search`
- **æ–‡ä»¶**:
  - Controller: `search-controller.js`
  - Service: `search-service.js`
  - Routes: `search-routes.js`

#### 6. ğŸ“– ç¬”è®°æ¨¡å— (`/note`)
- **åŠŸèƒ½**: éŸ³ä¹ç¬”è®°å‘å¸ƒã€å›¾ç‰‡ç®¡ç†ã€ç¬”è®°ç¼–è¾‘
- **æ¥å£å‰ç¼€**: `/note`
- **æ–‡ä»¶**:
  - Controller: `note-controller.js`
  - Service: `note-service.js`
  - Routes: `note-routes.js`

#### 7. ğŸ’¬ ç¤¾äº¤æ¨¡å— (`/social`)
- **åŠŸèƒ½**: è¯„è®ºã€ç‚¹èµã€ç§ä¿¡ã€é€šçŸ¥ç®¡ç†
- **æ¥å£å‰ç¼€**: `/social`
- **æ–‡ä»¶**:
  - Controller: `social-controller.js`
  - Service: `social-service.js`
  - Routes: `social-routes.js`

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16.0.0
- pnpm >= 7.0.0
- MySQL >= 8.0
- Redis >= 6.0

### å®‰è£…ä¾èµ–

```bash
# å®‰è£…é¡¹ç›®ä¾èµ–
pnpm install
```

### ç¯å¢ƒé…ç½®

1. å¤åˆ¶ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶
```bash
cp .env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“å’ŒRedisè¿æ¥ä¿¡æ¯
```bash
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your-password
DB_NAME=netease_music_db

# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# JWTå¯†é’¥
JWT_SECRET=your-super-secret-jwt-key
```

### æ•°æ®åº“åˆå§‹åŒ–

```bash
# åˆ›å»ºæ•°æ®åº“
mysql -u root -p
CREATE DATABASE netease_music_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# æ‰§è¡Œå»ºè¡¨è„šæœ¬
mysql -u root -p netease_music_db < database/create_tables.sql
```

### å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘ç¯å¢ƒå¯åŠ¨
pnpm run dev

# ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
pnpm start

# è¿è¡Œæµ‹è¯•
pnpm test
```

## ğŸ“š APIæ¥å£æ–‡æ¡£

### åŸºç¡€ä¿¡æ¯

- **Base URL**: `http://localhost:3000/api/v1`
- **è®¤è¯æ–¹å¼**: Bearer Token (JWT)
- **å“åº”æ ¼å¼**: JSON

### ğŸ“‹ æ¥å£è§„èŒƒè¯´æ˜

ä¸ºäº†ä¿æŒæ¥å£çš„ä¸€è‡´æ€§å’Œç®€æ´æ€§ï¼Œæœ¬é¡¹ç›®é‡‡ç”¨ä»¥ä¸‹æ¥å£è§„èŒƒï¼š

#### ğŸ”§ HTTPæ–¹æ³•è§„èŒƒ
- **GET**: ç”¨äºè·å–æ•°æ®çš„æ¥å£
- **POST**: ç”¨äºæ‰€æœ‰ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼ˆåˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ç­‰ï¼‰

#### ğŸ¯ URLå‘½åè§„èŒƒ
- **æ¨¡å—è·¯å¾„**: æ‰€æœ‰æ¥å£æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç»„ï¼Œä½¿ç”¨å•æ•°å½¢å¼
  - ç”¨æˆ·æ¨¡å—: `/user/*`
  - æ­Œæ›²æ¨¡å—: `/song/*` 
  - æ­Œå•æ¨¡å—: `/playlist/*`
  - æœç´¢æ¨¡å—: `/search/*`
  - ç¬”è®°æ¨¡å—: `/note/*`
  - ç¤¾äº¤æ¨¡å—: `/social/*`

#### ğŸ“ å‚æ•°ä¼ é€’è§„èŒƒ
- **GETè¯·æ±‚**: ä½¿ç”¨URLå‚æ•°(query string)ä¼ é€’æ•°æ®
- **POSTè¯·æ±‚**: 
  - æŸ¥è¯¢ç±»æ“ä½œ: ä½¿ç”¨queryå‚æ•°
  - ä¿®æ”¹ç±»æ“ä½œ: ä½¿ç”¨request bodyä¼ é€’æ•°æ®
  - æ–‡ä»¶ä¸Šä¼ : ä½¿ç”¨multipart/form-data

#### ğŸ’¡ è®¾è®¡åŸåˆ™
1. **ç®€æ´æ€§**: åªä½¿ç”¨GETå’ŒPOSTä¸¤ç§HTTPæ–¹æ³•ï¼Œé™ä½å‰ç«¯å¼€å‘å¤æ‚åº¦
2. **ä¸€è‡´æ€§**: æ‰€æœ‰æ¨¡å—éµå¾ªç›¸åŒçš„å‘½åå’Œå‚æ•°ä¼ é€’è§„èŒƒ
3. **è¯­ä¹‰åŒ–**: URLè·¯å¾„æ¸…æ™°è¡¨è¾¾åŠŸèƒ½å«ä¹‰
4. **RESTful**: åœ¨ç®€åŒ–çš„åŸºç¡€ä¸Šä¿æŒRESTfulè®¾è®¡ç†å¿µ

#### ğŸ“‹ å¸¸è§æ“ä½œæ˜ å°„
| æ“ä½œç±»å‹ | HTTPæ–¹æ³• | URLç¤ºä¾‹ | å‚æ•°ä½ç½® |
|---------|---------|---------|----------|
| è·å–åˆ—è¡¨ | GET | `/user/list` | query |
| è·å–è¯¦æƒ… | GET | `/user/detail/:id` | path + query |
| åˆ›å»ºèµ„æº | POST | `/user/create` | body |
| æ›´æ–°èµ„æº | POST | `/user/update` | body (åŒ…å«id) |
| åˆ é™¤èµ„æº | POST | `/user/remove` | body (åŒ…å«id) |
| åŠŸèƒ½æ“ä½œ | POST | `/user/follow` | body |

### ä¸»è¦æ¥å£æ¨¡å—

#### ğŸ” è®¤è¯æ¥å£ (`/auth`)
```bash
POST /auth/register     # ç”¨æˆ·æ³¨å†Œ
POST /auth/login        # ç”¨æˆ·ç™»å½•
POST /auth/refresh      # åˆ·æ–°ä»¤ç‰Œ
POST /auth/logout       # é€€å‡ºç™»å½•
GET  /auth/me          # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
```

#### ğŸ‘¤ ç”¨æˆ·æ¥å£ (`/user`)
```bash
GET  /user/info              # è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
POST /user/update            # æ›´æ–°ç”¨æˆ·ä¿¡æ¯
GET  /user/profile/:id       # è·å–æŒ‡å®šç”¨æˆ·ä¿¡æ¯
GET  /user/history           # è·å–æ’­æ”¾å†å²
GET  /user/favorites         # è·å–å–œæ¬¢çš„æ­Œæ›²
POST /user/follow            # å…³æ³¨ç”¨æˆ· (body: {userId})
POST /user/unfollow          # å–æ¶ˆå…³æ³¨ (body: {userId})
GET  /user/following         # è·å–å…³æ³¨åˆ—è¡¨
GET  /user/followers         # è·å–ç²‰ä¸åˆ—è¡¨
POST /user/avatar            # ä¸Šä¼ å¤´åƒ
GET  /user/settings          # è·å–ç”¨æˆ·è®¾ç½®
POST /user/settings          # æ›´æ–°ç”¨æˆ·è®¾ç½®
```

#### ğŸµ æ­Œæ›²æ¥å£ (`/song`)
```bash
GET  /song/list              # è·å–æ­Œæ›²åˆ—è¡¨
GET  /song/detail/:id        # è·å–æ­Œæ›²è¯¦æƒ…
POST /song/create            # åˆ›å»ºæ­Œæ›²
POST /song/update            # æ›´æ–°æ­Œæ›² (body: {id, ...})
POST /song/remove            # åˆ é™¤æ­Œæ›² (body: {id})
POST /song/play              # æ’­æ”¾æ­Œæ›² (body: {id})
GET  /song/hot               # è·å–çƒ­é—¨æ­Œæ›²
GET  /song/recommend         # è·å–æ¨èæ­Œæ›²
POST /song/like              # å–œæ¬¢æ­Œæ›² (body: {songId})
POST /song/unlike            # å–æ¶ˆå–œæ¬¢ (body: {songId})
```

#### ğŸ“ æ­Œå•æ¥å£ (`/playlist`)
```bash
GET  /playlist/list          # è·å–æ­Œå•åˆ—è¡¨
GET  /playlist/detail/:id    # è·å–æ­Œå•è¯¦æƒ…
POST /playlist/create        # åˆ›å»ºæ­Œå•
POST /playlist/update        # æ›´æ–°æ­Œå• (body: {id, ...})
POST /playlist/remove        # åˆ é™¤æ­Œå• (body: {id})
GET  /playlist/songs/:id     # è·å–æ­Œå•æ­Œæ›²
POST /playlist/add-song      # æ·»åŠ æ­Œæ›²åˆ°æ­Œå• (body: {playlistId, songId})
POST /playlist/remove-song   # ä»æ­Œå•ç§»é™¤æ­Œæ›² (body: {playlistId, songId})
POST /playlist/collect       # æ”¶è—æ­Œå• (body: {playlistId})
POST /playlist/uncollect     # å–æ¶ˆæ”¶è— (body: {playlistId})
GET  /playlist/collected     # è·å–æ”¶è—çš„æ­Œå•
```

#### ğŸ” æœç´¢æ¥å£ (`/search`)
```bash
GET  /search                 # ç»¼åˆæœç´¢ (query: {keyword, type, page, limit})
GET  /search/song            # æœç´¢æ­Œæ›²
GET  /search/artist          # æœç´¢æ­Œæ‰‹
GET  /search/playlist        # æœç´¢æ­Œå•
GET  /search/user            # æœç´¢ç”¨æˆ·
GET  /search/history         # è·å–æœç´¢å†å²
POST /search/history/clear   # æ¸…ç©ºæœç´¢å†å²
GET  /search/hot             # è·å–çƒ­é—¨æœç´¢
```

#### ğŸ“– ç¬”è®°æ¥å£ (`/note`)
```bash
GET  /note/list              # è·å–ç¬”è®°åˆ—è¡¨
GET  /note/detail/:id        # è·å–ç¬”è®°è¯¦æƒ…
POST /note/create            # å‘å¸ƒç¬”è®°
POST /note/update            # æ›´æ–°ç¬”è®° (body: {id, ...})
POST /note/remove            # åˆ é™¤ç¬”è®° (body: {id})
GET  /note/my                # è·å–æˆ‘çš„ç¬”è®°
POST /note/upload-image      # ä¸Šä¼ ç¬”è®°å›¾ç‰‡
```

#### ğŸ’¬ ç¤¾äº¤æ¥å£ (`/social`)
```bash
GET  /social/comment/:targetId    # è·å–è¯„è®ºåˆ—è¡¨ (query: {type})
POST /social/comment              # å‘è¡¨è¯„è®º (body: {targetId, targetType, content})
POST /social/comment/remove       # åˆ é™¤è¯„è®º (body: {commentId})
POST /social/like                 # ç‚¹èµ (body: {targetId, targetType})
POST /social/unlike               # å–æ¶ˆç‚¹èµ (body: {targetId, targetType})
GET  /social/notification         # è·å–é€šçŸ¥åˆ—è¡¨
POST /social/notification/read    # æ ‡è®°é€šçŸ¥å·²è¯» (body: {notificationId})
GET  /social/chat/list            # è·å–èŠå¤©åˆ—è¡¨
GET  /social/chat/:userId         # è·å–èŠå¤©è®°å½•
POST /social/chat/send            # å‘é€æ¶ˆæ¯ (body: {userId, content})
```

### ğŸ”§ æ¥å£è°ƒç”¨ç¤ºä¾‹

#### è·å–æ•°æ®ç¤ºä¾‹ (GET)
```bash
# è·å–ç”¨æˆ·ä¿¡æ¯
GET /api/v1/user/info
Authorization: Bearer <token>

# è·å–æ­Œæ›²åˆ—è¡¨ (å¸¦åˆ†é¡µ)
GET /api/v1/song/list?page=1&limit=20&category=pop

# æœç´¢æ­Œæ›²
GET /api/v1/search/song?keyword=å‘¨æ°ä¼¦&page=1&limit=10
```

#### ä¿®æ”¹æ•°æ®ç¤ºä¾‹ (POST)
```bash
# æ›´æ–°ç”¨æˆ·ä¿¡æ¯
POST /api/v1/user/update
Authorization: Bearer <token>
Content-Type: application/json

{
  "nickname": "æ–°æ˜µç§°",
  "avatar": "å¤´åƒURL"
}

# å…³æ³¨ç”¨æˆ·
POST /api/v1/user/follow
Authorization: Bearer <token>
Content-Type: application/json

{
  "userId": 12345
}

# æ’­æ”¾æ­Œæ›²
POST /api/v1/song/play
Authorization: Bearer <token>
Content-Type: application/json

{
  "id": 98765
}
```

### ç»Ÿä¸€å“åº”æ ¼å¼

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": { ... },
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 100,
    "totalPages": 5
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

#### é”™è¯¯å“åº”
```json
{
  "success": false,
  "code": 400,
  "message": "å‚æ•°é”™è¯¯",
  "errorCode": "VALIDATION_ERROR",
  "errors": [
    {
      "field": "email",
      "message": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®"
    }
  ],
  "timestamp": "2024-01-15T10:30:00Z"
}
```

## ğŸ”§ å¼€å‘è¯´æ˜

### æµç¨‹å›¾è¯´æ˜

ä¸Šè¿°ä¸šåŠ¡é€»è¾‘æµç¨‹å›¾å±•ç¤ºäº†ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼š

1. **ğŸ” ç”¨æˆ·è®¤è¯æµç¨‹** - æ¶µç›–æ³¨å†Œã€ç™»å½•ã€ä»¤ç‰Œåˆ·æ–°çš„å®Œæ•´è®¤è¯æœºåˆ¶
2. **ğŸµ éŸ³ä¹æ’­æ”¾æµç¨‹** - ä»ç”¨æˆ·ç‚¹å‡»æ’­æ”¾åˆ°æ¨èç®—æ³•æ›´æ–°çš„å®Œæ•´é“¾è·¯
3. **ğŸ“ æ­Œå•ç®¡ç†æµç¨‹** - æ­Œå•åˆ›å»ºã€æ­Œæ›²ç®¡ç†ã€æ”¶è—åŠŸèƒ½çš„ä¸šåŠ¡é€»è¾‘
4. **ğŸ” æœç´¢æµç¨‹** - å¤šç±»å‹æœç´¢ã€ç»“æœå¤„ç†ã€å†å²è®°å½•çš„å¤„ç†æµç¨‹
5. **ğŸ’¬ ç¤¾äº¤äº’åŠ¨æµç¨‹** - å…³æ³¨ã€è¯„è®ºã€ç‚¹èµã€ç§ä¿¡ç­‰ç¤¾äº¤åŠŸèƒ½çš„å®ç°
6. **ğŸ¯ æ¨èç®—æ³•æµç¨‹** - åŸºäºç”¨æˆ·è¡Œä¸ºçš„ä¸ªæ€§åŒ–æ¨èç®—æ³•å®ç°
7. **ğŸ—ï¸ ç³»ç»Ÿæ•´ä½“æ¶æ„** - å±•ç¤ºå„å±‚çº§ä¹‹é—´çš„ä¾èµ–å…³ç³»å’Œæ•°æ®æµè½¬
8. **ğŸ“Š æ•°æ®åº“å…³ç³»å›¾** - æ ¸å¿ƒæ•°æ®è¡¨ä¹‹é—´çš„å…³è”å…³ç³»

è¿™äº›æµç¨‹å›¾ä¸ºå¼€å‘äººå‘˜æä¾›äº†æ¸…æ™°çš„å®ç°æŒ‡å¯¼ï¼Œç¡®ä¿ä¸šåŠ¡é€»è¾‘çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ **ES6+** è¯­æ³•
- é‡‡ç”¨ **async/await** å¤„ç†å¼‚æ­¥æ“ä½œ
- æ‰€æœ‰æ•°æ®åº“æ“ä½œå¿…é¡»ä½¿ç”¨ **å‚æ•°åŒ–æŸ¥è¯¢** é˜²æ­¢SQLæ³¨å…¥
- ç»Ÿä¸€ä½¿ç”¨ **é©¼å³°å‘½åæ³•** (camelCase)
- æ¯ä¸ªå‡½æ•°éƒ½è¦æœ‰ **JSDocæ³¨é‡Š**

### é”™è¯¯å¤„ç†

- ä½¿ç”¨è‡ªå®šä¹‰ `AppError` ç±»å¤„ç†ä¸šåŠ¡é”™è¯¯
- å…¨å±€é”™è¯¯å¤„ç†ä¸­é—´ä»¶æ•è·æ‰€æœ‰å¼‚å¸¸
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•

### å®‰å…¨æªæ–½

- JWTä»¤ç‰Œè®¤è¯
- APIè¯·æ±‚é¢‘ç‡é™åˆ¶
- è¾“å…¥å‚æ•°éªŒè¯
- SQLæ³¨å…¥é˜²æŠ¤
- XSSé˜²æŠ¤

### æ€§èƒ½ä¼˜åŒ–

- Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- åˆ†é¡µæŸ¥è¯¢é¿å…å¤§æ•°æ®é›†
- å“åº”æ•°æ®å‹ç¼©

## ğŸ“ å¼€å‘ä»»åŠ¡

å½“å‰é¡¹ç›®å·²æ­å»ºå®Œæ•´çš„æ¶æ„æ¡†æ¶ï¼Œå„æ¨¡å—çš„ **TODO** å®ç°ä»»åŠ¡åŒ…æ‹¬ï¼š

### ğŸ”¨ å¾…å®ç°åŠŸèƒ½

1. **ç”¨æˆ·æ¨¡å—å®Œå–„**
   - [ ] æ’­æ”¾å†å²æŸ¥è¯¢é€»è¾‘
   - [ ] å–œæ¬¢æ­Œæ›²ç®¡ç†
   - [ ] å…³æ³¨å…³ç³»ç®¡ç†

2. **æ­Œæ›²æ¨¡å—å¼€å‘**
   - [ ] æ­Œæ›²CRUDæ“ä½œ
   - [ ] æ’­æ”¾è®°å½•ç»Ÿè®¡
   - [ ] æ¨èç®—æ³•å®ç°

3. **æ­Œå•æ¨¡å—å¼€å‘**
   - [ ] æ­Œå•CRUDæ“ä½œ
   - [ ] æ­Œå•æ­Œæ›²ç®¡ç†
   - [ ] æ”¶è—åŠŸèƒ½

4. **æœç´¢æ¨¡å—å¼€å‘**
   - [ ] å…¨æ–‡æœç´¢å®ç°
   - [ ] æœç´¢å†å²è®°å½•
   - [ ] çƒ­é—¨æœç´¢ç»Ÿè®¡

5. **ç¤¾äº¤æ¨¡å—å¼€å‘**
   - [ ] è¯„è®ºç³»ç»Ÿ
   - [ ] ç‚¹èµåŠŸèƒ½
   - [ ] ç§ä¿¡èŠå¤©

6. **ç¬”è®°æ¨¡å—å¼€å‘**
   - [ ] ç¬”è®°CRUDæ“ä½œ
   - [ ] å›¾ç‰‡ä¸Šä¼ ç®¡ç†
   - [ ] ç¬”è®°ç¤¾äº¤åŠŸèƒ½

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test

# è¿è¡Œæµ‹è¯•å¹¶ç›‘å¬æ–‡ä»¶å˜åŒ–
pnpm run test:watch

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
pnpm run test:coverage
```

## ğŸ“Š éƒ¨ç½²

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **ç¯å¢ƒå˜é‡é…ç½®**
```bash
NODE_ENV=production
PORT=3000
JWT_SECRET=your-production-secret
```

2. **ä½¿ç”¨PM2éƒ¨ç½²**
```bash
# å®‰è£…PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start src/app.js --name "music-api"

# æŸ¥çœ‹çŠ¶æ€
pm2 status
```

3. **Nginxåå‘ä»£ç†**
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location /api {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ’¬ è”ç³»æ–¹å¼

- é¡¹ç›®é“¾æ¥: [https://github.com/your-username/netease-music-api](https://github.com/your-username/netease-music-api)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/your-username/netease-music-api/issues)

---

**ğŸµ è®©æˆ‘ä»¬ä¸€èµ·æ„å»ºæ›´å¥½çš„éŸ³ä¹ä½“éªŒï¼** 